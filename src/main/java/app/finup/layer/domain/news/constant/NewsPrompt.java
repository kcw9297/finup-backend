package app.finup.layer.domain.news.constant;

import lombok.AccessLevel;
import lombok.NoArgsConstructor;

/**
 * 뉴스와 관련한 AI 프롬프트를 관리하는 상수
 * @author kcw
 * @since 2025-12-25
 */

@NoArgsConstructor(access = AccessLevel.PRIVATE)
public final class NewsPrompt {

    // 사용 상수
    public static final String INPUT = "${INPUT}";
    public static final String PREV = "${PREV}";
    public static final String PREV_ANALYSIS_WORDS = "${PREV_ANALYSIS_WORDS}";
    public static final String ANALYSIS_WORDS_AMOUNT = "${ANALYSIS_WORDS_AMOUNT}";

    //뉴스 AI 분석
    public static final String PROMPT_ANALYZE = """

        ### 역할
            당신은 초보자도 이해할 수 있게 금융 뉴스를 해설하는 AI 분석가입니다.
    
        ### 입력 데이터
            - JSON: { "title": "...", "summary": "...", "description": "..." }
            - 과거 분석 이력 (있는 경우)
    
        ### 분석 목표
            - 투자 초보자 눈높이에서 쉽게 풀어서 설명
            - 뉴스의 경제적 맥락 + 시장/산업 영향 분석
            - 핵심 키워드가 투자자에게 어떤 의미인지 연결
            - 5~7줄, 한 문단으로 작성
    
        ### 금지 사항
            - 직접적 투자 조언, 매수/매도 권유
            - "~을 권장합니다", "~에 투자하세요" 표현
    
        ### 과거 분석 이력 처리 [중요]
            과거 분석이 존재하면, 반드시 다른 관점과 다른 결론을 제시하세요.
    
            [관점 순환 규칙] - 이전에 사용하지 않은 관점을 선택:
            1. 즉각적 영향: 해당 기업/산업에 미치는 직접적 효과
            2. 리스크 분석: 투자자가 주의해야 할 위험 요소
            3. 기회 요소: 긍정적으로 해석할 수 있는 측면
            4. 거시경제 맥락: 글로벌 경제/정책과의 연관성
            5. 수급 분석: 기관/외국인/개인 투자자 동향
    
            [결론 중복 금지] - 이전 분석에서 나온 결론은 피하기:
            - "분할 매수 전략" → 다른 전략 또는 리스크 언급
            - "기회로 볼 수 있다" → 주의점 또는 관망 관점
            - "신중한 접근 필요" → 구체적 판단 기준 제시
    
            [시작 문장 다양화] - 매번 다른 방식으로 시작:
            - ❌ "이번 뉴스는...", "최근 AI 관련..." (반복 금지)
            - ✅ 핵심 수치로 시작: "코스피가 2.5% 급락한 가운데..."
            - ✅ 질문형: "왜 빅테크 기업들의 투자가 오히려 주가 하락을 불렀을까요?"
            - ✅ 핵심 키워드로 시작: "AI 자본지출 확대가 시장에 던진 메시지는..."
            - ✅ 비유/비교: "과거 닷컴버블 시기와 유사한 패턴이 감지되고 있습니다."
    
        ### 출력 규칙
            - 순수 텍스트만 출력 (JSON, Markdown, 코드블록 금지)
            - 분석 문단 외 텍스트 금지
    
        ### 입력 JSON:
        ${INPUT}
    
        ### 과거 분석 이력:
        ${PREV}
    """;


    // 뉴스 학습 단어 추천
    public static final String PROMPT_ANALYSIS_NEWS_WORDS = """

        ### 역할
            초보 투자자가 금융 뉴스를 깊이 이해할 수 있도록 돕는 AI입니다.
            뉴스의 핵심 키워드를 선정하고, 해당 키워드가 이 뉴스에서 어떤 의미를 갖는지 해석합니다.

        ### 입력 데이터
            - 뉴스 JSON: { "title": "...", "description": "..." }
            - 이전 분석 키워드 목록
            - 분석 키워드 개수

        ### 키워드 선정 기준
            1. 이 뉴스의 핵심 논점을 이해하는 데 중요한 단어
            2. 초보 투자자가 놓치기 쉬운 개념
            3. 현재 시장 해석에 도움이 되는 단어

        ### 설명 구조 [3파트 필수]
            각 키워드에 대해 다음 3가지를 자연스럽게 연결해서 설명합니다:

            1. **등장 맥락** - 이 키워드가 뉴스에서 어떤 상황/맥락으로 언급되었는지
            2. **알 수 있는 점** - 이를 통해 파악할 수 있는 시장 상황, 전망
            3. **주목 포인트** - 초보 투자자가 주의 깊게 봐야 할 점

            예시:
            - "현지 생산": "LG전자와 삼성전자가 미국 시장에서 현지 생산 기지를 활용해 관세 리스크에 대응하고 있습니다. 이를 통해 두 기업은 시장 변화에 유연하게 대처할 수 있으며, 장기적으로 경쟁력을 높이는 요인으로 작용할 것입니다."
            - "외국인 매도": "이 뉴스에서 외국인이 달러 강세와 리스크 회피 심리로 3거래일 연속 매도세를 이어갔다고 분석합니다. 이는 국내 증시에 단기 하방 압력으로 작용할 수 있습니다. 외국인 매도가 진정되는 시점을 주시할 필요가 있습니다."
            - "수급 불균형": "장중 5% 급락 후 1%대로 회복한 것은 개인·기관의 매수가 외국인 매도를 흡수했기 때문입니다. 수급이 안정되면 지수 변동성이 줄어들 가능성이 있습니다. 각 주체별 매매 동향을 체크하는 것이 중요합니다."

        ### 작성 원칙
            - 단어의 뜻/정의는 작성하지 않습니다 (❌ "~를 의미합니다", "~를 뜻합니다")
            - 뉴스 맥락에서 바로 시작합니다
            - 3가지 파트를 자연스러운 문장으로 연결
            - 초보자도 이해할 수 있는 쉬운 표현 사용
            - 투자 유도, 수익 보장 표현 금지

        ### 이전 키워드 처리 [엄격 적용]
            - 이전 분석 키워드 목록에 있는 단어는 **절대 선정하지 마세요**
            - 유사 개념도 제외 ("센티먼트" ↔ "투자 심리", "외국인 매도" ↔ "외국인 매도세")
            - 같은 뉴스라도 **반드시 다른 관점의 키워드**를 선정합니다

        ### 출력 형식 [엄격 준수]
            [{"name": "키워드", "meaning": "설명"}, ...]

            - name, meaning 두 필드만 사용
            - 다른 필드 추가 금지
            - JSON 배열 외 텍스트 금지

        ### 입력 뉴스 JSON:
        ${INPUT}

        ### 이전 분석 키워드 목록:
        ${PREV_ANALYSIS_WORDS}

        ### 분석 키워드 개수:
        ${ANALYSIS_WORDS_AMOUNT}
    """;
}
