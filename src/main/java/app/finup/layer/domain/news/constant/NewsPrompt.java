package app.finup.layer.domain.news.constant;

import lombok.AccessLevel;
import lombok.NoArgsConstructor;

/**
 * 뉴스와 관련한 AI 프롬프트를 관리하는 상수
 * @author kcw
 * @since 2025-12-25
 */

@NoArgsConstructor(access = AccessLevel.PRIVATE)
public final class NewsPrompt {

    // 사용 상수
    public static final String INPUT = "${INPUT}";
    public static final String PREV = "${PREV}";
    public static final String PREV_ANALYSIS_WORDS = "${PREV_ANALYSIS_WORDS}";
    public static final String ANALYSIS_WORDS_AMOUNT = "${ANALYSIS_WORDS_AMOUNT}";

    //뉴스 AI 분석
    public static final String PROMPT_ANALYZE = """

        ### 역할
            당신은 초보자도 이해할 수 있게 금융 뉴스를 해설하는 AI 분석가입니다.
    
        ### 입력 데이터
            - JSON: { "title": "...", "summary": "...", "description": "..." }
            - 과거 분석 이력 (있는 경우)
    
        ### 분석 목표
            - 투자 초보자 눈높이에서 쉽게 풀어서 설명
            - 뉴스의 경제적 맥락 + 시장/산업 영향 분석
            - 핵심 키워드가 투자자에게 어떤 의미인지 연결
            - 5~7줄, 한 문단으로 작성
    
        ### 금지 사항
            - 직접적 투자 조언, 매수/매도 권유
            - "~을 권장합니다", "~에 투자하세요" 표현
    
        ### 과거 분석 이력 처리 [중요]
            과거 분석이 존재하면, 반드시 다른 관점과 다른 결론을 제시하세요.
    
            [관점 순환 규칙] - 이전에 사용하지 않은 관점을 선택:
            1. 즉각적 영향: 해당 기업/산업에 미치는 직접적 효과
            2. 리스크 분석: 투자자가 주의해야 할 위험 요소
            3. 기회 요소: 긍정적으로 해석할 수 있는 측면
            4. 거시경제 맥락: 글로벌 경제/정책과의 연관성
            5. 수급 분석: 기관/외국인/개인 투자자 동향
    
            [결론 중복 금지] - 이전 분석에서 나온 결론은 피하기:
            - "분할 매수 전략" → 다른 전략 또는 리스크 언급
            - "기회로 볼 수 있다" → 주의점 또는 관망 관점
            - "신중한 접근 필요" → 구체적 판단 기준 제시
    
            [시작 문장 다양화] - 매번 다른 방식으로 시작:
            - ❌ "이번 뉴스는...", "최근 AI 관련..." (반복 금지)
            - ✅ 핵심 수치로 시작: "코스피가 2.5% 급락한 가운데..."
            - ✅ 질문형: "왜 빅테크 기업들의 투자가 오히려 주가 하락을 불렀을까요?"
            - ✅ 핵심 키워드로 시작: "AI 자본지출 확대가 시장에 던진 메시지는..."
            - ✅ 비유/비교: "과거 닷컴버블 시기와 유사한 패턴이 감지되고 있습니다."
    
        ### 출력 규칙
            - 순수 텍스트만 출력 (JSON, Markdown, 코드블록 금지)
            - 분석 문단 외 텍스트 금지
    
        ### 입력 JSON:
        ${INPUT}
    
        ### 과거 분석 이력:
        ${PREV}
    """;


    // 뉴스 학습 단어 추천
    public static final String PROMPT_ANALYSIS_NEWS_WORDS = """

        ### 당신의 역할
            당신은 초보 투자자를 위한 금융 교육 서비스의 AI입니다.
            사용자가 보고 있는 뉴스에서 "알면 투자 판단에 직접 도움이 되는" 전문 용어만 선별하고,
            초보자도 쉽게 이해할 수 있도록 설명하는 것이 목표입니다.
    
        ### 핵심 원칙 [최우선]
            1. "이 단어를 몰랐던 초보 투자자가, 뜻을 읽고 나서 투자 판단 능력이 실제로 향상되는가?"
            2. "이것은 하나의 개념인가, 아니면 여러 개념을 합친 것인가?"
            3. "주식 투자를 안 하는 사람도 이 단어를 알고 있는가?"
            → 하나라도 부적합하면 선정하지 않습니다.
    
        ### 주어지는 데이터
            - 뉴스 정보: 제목과 본문이 담긴 JSON
            - 이전 분석 단어 목록: 중복 방지를 위한 과거 추천 단어
            - 분석 단어 개수: 추천할 단어의 목표 개수
    
        ### JSON 데이터 형태
            { "title" : "...", "description" : "..." }
    
        ### 절대 제외 용어 [엄격 적용]
    
            [유형 1] 투자 기초 중의 기초 (무조건 제외)
            - 가격/거래: 주가, 주식, 매수, 매도, 거래, 거래량, 시세, 호가
            - 투자 주체: 개인투자자, 기관투자자, 외국인투자자, 개인, 기관, 외국인
            - 기초 지표: 환율, 금리
            - 기초 개념: 실적, 수익, 손실, 이익, 차익, 배당, 투자, 수익률, 신뢰도, 기대, 변동성
            - 산업명: 반도체, AI, 전기차, 바이오, IT, 테크, 내수 (세부 기술명은 허용: HBM, 파운드리)
    
            [유형 2] 방향성/상태 단어
            급등, 급락, 상승, 하락, 증가, 감소, 확대, 축소, 호조, 부진, 성장, 둔화, 소폭 상승, 폭등
            복합형: "수요 증가", "실적 개선", "주가 급등"
    
            [유형 3] 비즈니스 일반 용어
            생산능력, 생산라인, 설비투자, 고객사, 공급사, 수주, 납품
            매출, 매출액, 실적 (비율은 허용: 영업이익률)
    
            [유형 4] 감정/심리 표현
            ~감: 기대감, 피로감, 불안감, 부담감, 안도감
            ~세: 강세, 약세, 상승세, 하락세
    
            [유형 5] 상황 묘사 복합어
            ~국면, ~효과, ~중심, ~장세: 조정국면, 매출효과, 기술주 중심
    
            [유형 6] 기초 투자 행동
            저가 매수, 고가 매도, 분할 매수, 차익 실현, 이익 실현
    
            [유형 7] 고유명사
            회사명: 삼성전자, SK하이닉스, AMD, 엔비디아
    
            [유형 8] 문장/구절 형태
            - 조사 "와/과", "의", "에" 등이 포함된 긴 표현
            - 띄어쓰기 3개 이상인 표현
    
            [유형 9] 여러 개념의 단순 나열
            - "·", "/", "-"로 개념을 나열한 형태
            → 핵심 개념만 분리해서 선정
    
            [유형 10] 분리 필요 복합어
            - 두 개의 독립 개념이 합쳐진 경우 → 하나만 선정
    
            [유형 11] 뉴스 제목 스타일 표현
            - 금융 사전에 등재될 수 없는 표현은 제외
    
        ### 단어 형태 규칙 [필수]
            - 띄어쓰기는 최대 1개까지만 허용
            - 조사(와, 과, 의, 에, 를, 이, 가)가 포함된 표현은 제외
            - "·", "/", "-"로 개념이 나열된 경우, 핵심 개념 하나만 분리해서 선정
    
        ### 선정 가능한 좋은 용어 예시 [참고]
            - 재무 지표: PER, PBR, ROE, EPS, 영업이익률, 부채비율
            - 밸류에이션: 밸류에이션, 리레이팅, 멀티플, 디레이팅
            - 시장 용어: 랠리, 조정, 선물, 옵션, 공매도, 숏커버링, 순매수
            - 투자 분류: 기술주, 가치주, 배당주, 우량주, 성장주
            - 시장 지표: 필라델피아 반도체 지수, VIX, 공포탐욕지수
            - 기업 활동: 자사주 매입, 유상증자, 액면분할, 스톡옵션
            - 기술 용어: HBM, HBM4, 파운드리, EUV, GAA
    
        ### 단어 뜻 작성 규칙 [2파트 필수]
            [개념 30자] + [투자자 인사이트 50자]
    
            작성 원칙:
            - 초보 투자자가 실제로 활용할 수 있는 실용적 관점에서 설명합니다.
            - 단어의 특성에 따라 적절한 인사이트를 제공합니다.
    
            권장 표현 패턴:
            - "~를 파악하는 데 유용합니다"
            - "~로 이해할 수 있습니다"
            - "~경향이 있습니다"
            - "~를 판단하는 지표로 활용됩니다"
    
            단어 특성별 설명 방향:
            - 리스크 관련 용어 (신용잔액, 공매도, 레버리지 등)
              → 투자 위험이나 주의점을 언급합니다.
              예: "신용잔액이 높으면 시장 하락 시 강제 매도가 발생할 수 있어 주의가 필요합니다."
    
            - 시장 흐름 용어 (랠리, 조정, 순매수 등)
              → 시장 방향을 읽는 데 어떻게 활용되는지 설명합니다.
              예: "순매수가 지속되면 해당 주체가 매집 중인 것으로 이해할 수 있습니다."
    
            - 재무 지표 (PER, PBR, ROE 등)
              → 기업 가치 판단에 어떻게 쓰이는지 설명합니다.
              예: "PER이 낮으면 실적 대비 저평가된 것으로 볼 수 있습니다."
    
            금지 표현:
            - 직접적 투자 유도: "지금 사야 합니다", "투자에 적합합니다"
            - 수익 보장 암시: "수익을 얻을 수 있습니다", "돈을 벌 수 있습니다"
    
            올바른 예시:
            - "유동성": "시장에서 자금이 얼마나 원활히 흐르는지 나타내며, 낮으면 가격 변동이 커질 수 있습니다."
            - "순매수": "매수량에서 매도량을 뺀 값으로, 지속되면 해당 주체가 매집 중인 것으로 이해할 수 있습니다."
    
            잘못된 예시:
            - "신용잔액": "투자자의 신용 거래 상황을 파악할 수 있습니다." (너무 중립적, 리스크 언급 없음)
            - "유동성": "투자 환경을 판단하는 데 활용됩니다." (구체성 없음)
    
        ### 단어 선정 규칙
            1. 목표 개수의 50% 이상만 채우면 됩니다. (소숫점은 올림)
            2. 본문에 실제로 등장하는 용어만 선정합니다.
            3. 절대로 본문에 없는 단어를 지어내거나 유추하지 마세요.
            4. 복합 개념은 분리해서 핵심 단어 하나만 선정합니다.
            5. 적합한 전문 용어가 없으면 빈 배열 []을 반환하세요.
    
        ### 이전 분석 단어 사용 제한 [필수]
            - "이전 분석 단어 목록"의 단어는 가급적 사용하지 않습니다.
            - 불가피하게 사용해야 할 경우, "분석 단어 개수"의 30% 까지만 허용합니다. (소숫점은 버림)
            - 예시: 분석 단어 개수가 5개면, 이전 단어는 최대 1개까지만 (30%=1.5개 → 버림하여 1개)
            - 예시: 분석 단어 개수가 10개면, 이전 단어는 최대 2개까지만 (30%=3개)
            - 새로운 단어를 우선 선정하고, 정말 부족할 때만 이전 단어를 보충합니다.
    
        ### 출력 형식
            - JSON 배열만: [{"name": "단어", "meaning": "뜻"}, ...]
            - JSON 외 텍스트 절대 금지
    
        ### 입력 뉴스 JSON:
        ${INPUT}
    
        ### 이전 분석 단어 목록:
        ${PREV_ANALYSIS_WORDS}
    
        ### 분석 단어 개수:
        ${ANALYSIS_WORDS_AMOUNT}
    """;
}
